# Сервис Category Tree

## Цели сервиса
Сервис **Category Tree** отвечает за обработку и представление данных о дереве категорий. Он преобразует данные из сервиса **Category** в удобный формат для отображения, передачи или скачивания.

## Основные требования

### 1. Получение данных о дереве категорий
- **Получение полного дерева категорий для определенного пользователя** в виде объекта `CategoryDto`.
    - Данные для `CategoryTto(массив)`:
        - `Long categoryId`: Id категорий.
        - `Long categoryId`: Id родителя (если родителя нет то значение будет равно -1).
        - `String categoryName`: Имя категорий.

### 2. Форматирование данных
- **Строковое представление дерева**:
    - Система должна предоставить строковое представление дерева категорий, удобное для текстового вывода.

- **Преобразование дерева в файлы (Excel)**:
    - Система должна поддерживать преобразование дерева категорий в файл формата Excel для последующего скачивания.

## Взаимодействие с другими модулями
- **Category**: Сервис **Category** используется для получения исходных данных о категориях, которые затем передаются в **Category Tree** для дальнейшей обработки и представления в нужном формате.

# Вариант использования: Сервис Category Tree

## 1. Получение данных о категориях
**Цель**: Получить данные о категориях для дальнейшей работы системы.

### Шаги:
1. Система отправляет запрос на получение данных о категориях, указав `userId`.
2. Если удалось успешно получить данные:
    - Завершаем процесс.
3. Если данные не были получены:
    - Возвращается ошибка `ErrorResponse` с соответствующим сообщением об ошибке на стороне сервера.

## 2. Получение строкового представления дерева категорий
**Цель**: Предоставить пользователю иерархию категорий в текстовом формате, удобном для визуального восприятия.

### Шаги:
1. Система получает данные о категориях.
   1. Если данных нет получаем ошибку от категория сервис и обрабатываем,так же возвращается ошибка `ErrorResponse`.
2. Система создает алгоритм для преобразования дерева в виде одной строки.
3. Система возвращает ответ в виде объекта `CategoryTreeStringResponse` с полем `String categoryTree`, содержащим строковое представление дерева.

## 3. Обработка дерева категорий для скачивания в формате Excel
**Цель**: Предоставить пользователю возможность скачать дерево категорий в виде Excel-файла, включающего иерархическую структуру категорий.

### Шаги:
1. Система получает данные о категориях.
   1. Если данных нет получаем ошибку от категория сервис и обрабатываем,так же возвращается ошибка `ErrorResponse`.
2. На основе структуры `CategoryTreeDto` создается Excel-файл (представленный как массив байтов).
3. Система возвращает объект `CategoryTreeFileResponse` с полем `byte[]`, содержащим данные о файле.


# Работа системы для Category Tree

В системе реализованы следующие основные методы для работы с деревом категорий:

## 1. Получение строкового представления дерева категорий
- **Метод:** `GET /viewTree/{userId}`
- **Описание:**
    - Принимает `userId` из пути запроса.
    - Возвращает строковое представление дерева категорий для указанного пользователя в виде объекта `CategoryTreeStringResponse`.
    - Форматированное дерево категорий предоставляется в текстовом виде, чтобы пользователь мог легко визуализировать иерархию категорий.
- **Пример запроса:**
    ```
    GET viewTree/123
    ```
- **Пример ответа:**
    ```json
    {
        "categoryTree": "Root Category\n  - Child Category 1\n    - Grandchild Category 1"
    }
    ```

---

## 2. Скачивание дерева категорий в формате Excel
- **Метод:** `GET /download/{userId}`
- **Описание:**
    - Принимает `userId` из пути запроса.
    - Возвращает дерево категорий для указанного пользователя в виде Excel-файла.
    - Файл представляет собой иерархическую структуру категорий, сохраненную в формате Excel для удобного использования и скачивания.
- **Пример запроса:**
    ```
    GET /download/123
    ```
- **Пример ответа:**
    - Ответ содержит Excel-файл в формате `byte[]`. Для скачивания будет предоставлена ссылка или файл, в зависимости от реализации.

